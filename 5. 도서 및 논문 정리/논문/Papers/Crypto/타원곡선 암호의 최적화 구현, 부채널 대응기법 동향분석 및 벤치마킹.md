---
tags:
  - 논문
  - 암호학
link: https://www.dbpia.co.kr/journal/articleDetail?nodeId=NODE10583223
category: Crypto
author: 송진교, 서석충
journal: 한국정보과학회
---
## 1. 논문의 핵심 요약
공개키 암호는 수학적인 난제에 기반을 두고 설계된 암호이기 때문에, **수학적인 연산이 많아** 대칭키 암호보다 성능 부하가 많이 걸리며, 수학적인 연산이 안전해도 **구현 시 부채널 공격에 대한 대응 방안**을 고려하지 않으면 부채널 취약점이 존재한다. 

따라서, 이 논문에서는 타원곡선 암호의 최적화 및 부채널 대응 방안에 대한 기존 연구 결과를 분석하고 이를 정리했다. 또한, 벤치마킹을 통해 각 연구에 대한 성능 측정 결과를 제시했다. 

---
## 2. 연구 목적
4차 산업혁명으로 스마트 홈, 스마트 시티, 스마트 팩토리 등의 신기한 서비스들을 사용자에게 제공하는 사회로 발전하고 있다. 이런 서비스들은 사용자에게 편리함을 줄 수 있지만, 대부분의 통신은 **무선으로 구현되었기 때문에** 해킹, 스푸핑, 중간자 공격 등의 보안 사고에 매우 취약하다. 

따라서 전송되는 데이터는 암호 알고리즘을 통해 보호되어야 하며, 그 중에서도 특히 공개키 암호는 <u>기밀성, 인증, 키 교환</u> 등의 보안 서비스를 제공하는 데 핵심적인 역할을 한다. 

---
## 3. 문제 정의
현재 널리 사용되는 공개키 암호 알고리즘은 타원곡선 암호 알고리즘으로, ECDLP에 안전성의 기반을 두고 있다. 타원곡선 암호 알고리즘은 RSA에 비해 짧은 키 길이, 빠른 연산속도, 더 작은 메모리 소모량 등의 장점이 있지만, 그래도 대칭키 암호에 비해서는 연산 부하가 많이 걸리기 때문에 성능 향상을 위해서는 **각 플랫폼에 맞춰진 최적화 연구가 필요하다.**

---
## 4. 핵심 아이디어
논문에서는 타원곡선 암호의 최적화, 부채널 대응 방안의 연구 동향을 살펴본다. 

**최적화 관점**
1. Jacobian Projective
2. Window NAF
3. Comb
4. 벤치마킹을 통한 연산 최적화 성능 측정 결과

**부채널 공격 대응 관점**
1. 전력분석인 SPA(Simple Power Analysis)의 대응 방안
2. 벤치마킹을 통한 부채널 대응 방안에 대한 성능 측정 결과

---
## 5. 타원곡선 암호의 최적화 구현 연구 동향
### Jacobian Projective
Projective는 한글로 하면 "사영"이란 의미로, $(x, y)$ 좌표는 Affine Coordinate라 하며, 타원곡선의 주된 특징으로는 2차원 좌표계인 Affine을 3차원으로 확장이 가능하다. 이는 Affine coordinate의 점을 $(\frac{x}{z}, \frac{y}{z})$로 표현하여 3차원 좌표에 $(x, y, z)$로 표현해 **성능을 가장 많이 잡아먹는 역원 연산을 없앨 수 있다는 강력한 장점으로 존재한다.**

기존 Standard Projective Coordinate에서 $z$의 지수승이 2, 3으로 설정된 Jacobian Coordinate는 $(x, y, z) = (\frac{x}{z^2}, \frac{y}{z^3}, 1) \in E: y^2 = x^3 + axz^4 + bz^6$으로 표현된다. 이는 Affine 기반의 연산량과 비교했을 때 곱셈 연산이 조금 늘어나지만, 역원 연산이 제거되어 성능이 극대화된다.

다음 사진은 고급암호학및실습 강의에서 배운 Point Representation 부분의 사진이다. 
![[Pasted image 20260221155201.png]]

### Window NAF
다음 사진을 보면, Binary Method에서 1이 나타날 때는 ECADD, ECDBL의 연산을 실행하지만, 0이 나타날 때는 ECDBL 연산만 실행하는 것을 볼 수 있다. 

![[Pasted image 20260221155339.png]]

이 때 나온 아이디어로 **NAF (Non-Adjacent Form)** 이 있는데, 쉽게 말하면 1의 개수를 줄여 연산을 최대한 적게 하자는 아이디어이다. 

기존 타원곡선 암호에서의 스칼라 비트는 0, 1만을 사용했지만, NAF에서는 거기에 -1을 더 추가해 스칼라 비트 1의 개수를 최소화한다. 예를 들어, $(11111111)_2 = 255$에는 스칼라 비트에 -1을 사용하면 $(10000000\overline{1})_2 = 255$로 더 간결하게 나타낼 수 있다. 이는 **8번의 ECADD 연산을 2번만 해도 되는 것과 동일하다.**

Window NAF를 적용하기 위해서는 먼저, 스칼라 비트를 -1로 확장하기 위한 NAF 변환을 수행해야 하며, 이후 Window Size를 정해 그만큼 비트를 스캔하여 스칼라 곱셈을 수행한다. NAF 스칼라 곱셈 알고리즘은 다음과 같다. 

![[Pasted image 20260221160350.png]]

이를 위해서는 Window Size만큼의 Precomputation이 필요하지만, 일반적으로 4에서 7비트의 Window Size를 많이 사용하기 때문에 Precomputation이 많지 않아 가변 점 스칼라 곱셈에서 효율적으로 사용할 수 있다. 

### Comb
Comb 스칼라 곱셈 방법은 스칼라 비트열을 $w$ 비트가 되도록 균등하게 분할한 뒤, 열 단위로 스칼라 비트를 스캔해 스칼라 곱셈을 수행하는 방법으로, 쉽게 말하면 머리를 빗는 **빗(Comb)** 과 비슷하게 스칼라 값 $k$를 긴 한 개의 줄로 보지 않고 여러 개의 블록으로 나눈 뒤, 미리 점들의 조합을 계산한 테이블을 참고해 최적화를 수행하는 방법이다. 

다음 사진과 같은 예시가 있다고 하자. 

![[Pasted image 20260221161451.png]]

- 스칼라 비트: $(001101011110)_2 = 862$
- 비트 열: 4
- 비트 행: 3

이 때 위의 표와 같이 862에 대한 스칼라 비트가 행과 열의 표로 나눠진다. 

스칼라 곱셈 시 이를 열 단위로 스캔해 스칼라 곱셈이 수행되기 때문에 위 예시에서는 512P, 64P, 8P, P에 대한 Precomputation이 필요하다. 따라서, Window NAF 방법보다 더 많은 Precomputation이 필요하기 때문에 고정된 점에 대한 스칼라 곱셈에서 매우 효율적이다. 

Comb 알고리즘의 전체 과정은 다음과 같다. 
![[Pasted image 20260221162016.png]]

---
## 6. 타원곡선 암호의 부채널 대응방안에 대한 연구 동향
이 절에서는 타원곡선 암호에 대한 대표적인 부채널 공격인 Simple Power Analysis 공격에 대한 대응방안 연구 동향을 분석한다.
### Atomic Block
ECC의 단순 구현은 스칼라 비트가 0이냐 1이냐에 따라 ECADD의 여부가 갈려 연산 수행량이 차이가 나기 때문에 SPA에 취약하다. 이를 카운터치기 위한 아주 간단한 방법으로 스칼라 비트가 0이건 1이건 상관없이 죄다 ECADD, ECDBL 연산을 수행할 수도 있지만, 이는 성능 부하도 같이 발생할 수 있는 단점이 있다. 

이에 대해 나온 방법으로 Atomic Block이 있는데, 이는 ECADD, ECDBL 두 연산의 내부를 부채널적으로 동치관계인 Atomic Block = 단위 블록들로 구성해 공격자의 SPA 공격을 어렵게 하는 것이다. 

선행 연구(첫 번째)에서는 ECADD, ECDBL을 구성하기 위해 $+,\ -, \ \times$를 하나의 Atomic한 Block으로 만들었다. ECADD는 10개, ECDBL은 16개의 Atomic Block으로 구성했으며, 일부 페이크 연산도 넣어 부채널적으로 동치관계로 구성했다. 전체 과정은 아래와 같다.

![[Pasted image 20260221163237.png]]

### Improved Montgomery
Improved Montgomery 방법은 기존의 Montgomery Ladder보다 더 진화된 방식으로, 선행 연구(2번째)에서는 Projective 기반 Montgomery Ladder 방법에서 $X, Z$ 좌표만 Montgomery Ladder 방법으로 수행하고 $Y$ 좌표는 마지막에 한 번에 복구하는 방식으로 $Y$ 좌표에 대한 계산을 제거했다. 

xECADDDBL 함수를 통해 스칼라 비트를 스캔하며, $X, Z$ 좌표에 대해서만 계산한 뒤 $Y$ 좌표는 마지막 YRecovery 함수를 통해서 구할 수 있다. 

---
## 7. 벤치마킹을 통한 성능 측정 결과
이 논문에서는 타원곡선 P-256에 대한 최적화 및 부채널 대응방안 연구에서의 성능을 비교했다. 

| Title | Content                                        |
| ----- | ---------------------------------------------- |
| 환경    | Intel Core i7-9700K, Visual Studio Release x64 |
| 성능    | CPU Cycle, 총 10000번의 평균 결과로 측정                 |

성능 측정 결과는 다음 표와 같으며, Binary 구현 대비 상승치는 Jacobian Coordinate와 비교한 결과이다. 

![[Pasted image 20260221164618.png]]

최적화 구현에서는 **Comb 스칼라 곱셈 방법**이 가장 빠른 성능을, 부채널 대응 방안에서는 **Atomic Block 방법**이 가장 빠른 성능을 달성했다. 

---
## 8. 결론 및 한계
이 논문에서는 타원곡선 암호에 대한 최적화 구현 및 부채널 대응 기법에 대한 동향을 다양하게 분석하고, 이를 벤치마킹하여 실제 성능 측정 결과를 제시했다. 

그러나, 타원곡선 P-256에 대해서만 벤치마킹하여 성능 측정 결과를 제시하였기 때문에, 차세대 곡선인 Curve25519, Curve448 등등에 대해서는 성능 측정 결과가 없어 어느 곡선에 어느 방법이 가장 최적화된 성능을 낼지에 대해서는 언급하지 않았다. 

---
## 9. 더 공부할 내용
[[224비트 ECDSA 하드웨어 기능 검증을 위한 소프트웨어 구현]] 논문 정리에서도 언급했지만, 3학년 1학기와 2학기에 다뤘던 관련 수업의 교재들을 보면서 복습이 많이 필요하겠다고 느꼈다. 

더 깊게 들어가자면 Jacobian Projective Coordinate와 NAF 개념에 대해서는 고급암호학및실습 강의에서 배웠지만, Comb 방식에 대해서는 이 논문에서 처음 보는 알고리즘이기 때문에, <u>다양한 최적화 관련 논문들을 정리하며 이 문서의 "관련 Obsidian 문서" 항목을 채워야겠다고 생각했다.</u> 

---
## 10. 비슷한 논문 / 선행 or 후속 연구
**관련 Obsidian 문서**
- [[224비트 ECDSA 하드웨어 기능 검증을 위한 소프트웨어 구현]]

**선행 연구**
- B.Chevallier-Mames, M.Ciet, and M.Joye, "Low-Cost Solutions for Preventing Simple-Channel Analysis: Side-Channel Atomicity", IEEE Transactions on Computers, Volume 53
- T.Izu, B.Moller, and T.Takagi, "Improved Elliptic Curve Multiplication Methods Resistant against Side Channel Attacks", Indocrypto 2002, India, December, 16-18

---