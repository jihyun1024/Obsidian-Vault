---
tags:
  - 암호학
  - 3학년_2학기
---
## 학습 주제
1. 공개키 암호: 타원곡선은 어떤 모습?
2. 타원곡선 vs 타원곡선군 vs 타원곡선암호
3. ECC in Bitcoin, secp256k1
4. 타원곡선 연산 최적화
5. 타원곡선 암호의 구현
6. ECC의 핵심: domain parameters

---
## 연관 수업
[[양자보안_4주차_월요일]]

---
## 수업과 관련한 질문 3가지
1. ECDH에서 이산대수 문제가 어떻게 적용되는지
2. ECDH에서 제 3자가 비밀값을 모르는 상황에서 효율적으로 공격할 수 있는 방법이 있는지
3. 격자점에서 바둑알들이 타원곡선군을 이룬다면, 그에 해당하는 연산은 뭔지

---
## 강의 요약
### 공개키 암호: 타원곡선은 어떤 모습?
![[Pasted image 20250928030812.png]]
[[양자보안_4주차_월요일]] 강의에서 설명했듯이, 컴퓨터는 무한한 수의 점을 저장하는 게 불가능하기 때문에 대신 유한체 $GF(p)$ 또는 $GF(2^n)$ 위의 몇 개의 점과 (단, 그 점들은 수학적으로 모두 연관되어 있다) 격자 위에 존재하지 않는 점인 무한원점(Point of Infinity)을 모두 모은 것을 타원곡선이라 부른다. 

### 타원곡선 vs 타원곡선군 vs 타원곡선암호
이 때, 왼쪽의 빨간 점들이 수학적으로 완벽한 구조를 이룬다면, 점 덧셈과 2배 연산으로 어떤 알고리즘을 정의할 수 있으며, 그걸 타원곡선군으로 정의하고, 이걸 이용해서 암호를 만든 것이 타원곡선암호이다. 

또한, 수식의 계수를 바꿈으로서 격자점 위의 바둑알, 즉 원소의 위치는 달라지며, 시작이 되는 점을 기저점, 즉 Base point라 이름 붙일 수 있다. 
![[Pasted image 20250928031524.png]]

그렇다면, 타원곡선을 정의하는 parameter 중에서 공개해도 되는 정보와 공개하면 안 되는 정보가 어떤 것들일까? 정답은 타원곡선 이산대수문제에서 찾을 수 있다. 

타원곡선 이산대수문제는 타원곡선 $E(F_q)$에서의 cyclic subgroup $G = <P>$에서 $Q =kP$와 $P$가 주어질 때, 이를 만족하는 $k$를 찾는 문제로, Diffie-Hellman 알고리즘에서 지수를 곱셈으로 바꾼 것과 비슷한 문제이다. 

이 문제에서 우리가 찾는 답은 $k$이기 때문에, $Q, P$는 공개되어도 괜찮지만, $k$는 공개되어서는 안 된다. 이는 우리가 지난 강의에서 언급했던 

`"이는 위 사진의 점을 통해 구현할 수 있으며, 파란 점들이 랜덤하게 나열된 것처럼 보이지만, 실제로는 1P 점에서 시작해서 277P까지 수학적으로 완벽한 구조를 이뤄 1 ~ 276까지 수 중에서 하나를 고르면 그게 각각 A,B 자신의 비밀 값이 되어 동작하는 원리를 가진다."`

와 일맥상통하여 결론적으로 비밀값은 숫자가 되며, 공개값은 $1P,..., 277P$까지 아무거나 될 수 있다. 그렇지만, 실제로는 $1P$가 공개값이 될 경우, 금방 비밀값인 1이 탄로날 수 있기 때문에 $1P$는 공개값으로나 비밀값으로 잘 사용하지 않는다. 
![[Pasted image 20250928032428.png]]

타원곡선은 다음의 종류로 나누어진다. 
- 이진 타원곡선(Binary): B-233, B-283
- Koblitz 타원곡선(Koblitz): K-233, K-283
- 소수 타원곡선(Prime): P-224, P-256

### ECC in Bitcoin, secp256k1
secp256k1은 비트코인, 이더리움 등에서 사용되는 타원곡선으로, 다음의 의미를 가진다. 

- **"SECP"는 "Standards for Efficient Cryptography Prime"의 약자.
- **"256"은 이 곡선이 256비트 보안을 제공한다는 의미.
- **"k1"은 이 곡선이 특정한 형태의 곡선(카오스틱 곡선, Koblitz curve)을 따른다는 뜻.**

이 타원곡선은 비트코인 주소 생성, 디지털 서명(ECDSA) 등에 사용되어 무결성과 인증을 보장하며, 빠르고 효율적이어서 많이 사용된다. 

secp256k1의 타원곡선 parameter는 다음 두 사진과 같다:
![[Pasted image 20250928033436.png|350x170]]![[Pasted image 20250928033524.png|350x180]]
잘 안보이니 더 크게 써 놓자면, 다음과 같다. 

- p = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F
	- 이는 $2^{256} - 2^32 - 2^9 - 2^8 - 2^7 - 2^6 - 2^4 - 1$과 동일하다. 
- 곡선의 방정식: $E: y^2=x^3 + 7$
- Base point G: 다음 사진과 같다. 
	- ![[Pasted image 20250928033926.png]]
- n: ![[Pasted image 20250928033953.png]]
- h: 01 (구현시 딱히 중요하지 않다)

### 타원곡선 연산 최적화
이전 강의에서 타원곡선 점 덧셈 연산이나 2배 연산시 연산량이 inverse, multiplication, squaring 등등 많은 연산을 필요로 하기 때문에 매우 복잡하다 했다. 
![[Pasted image 20250928034457.png|320x120]]![[Pasted image 20250928034517.png|340x120]]

예를 들어, $100P$를 계산해야 한다면, 100개의 $P$와 99번의 타원곡선 덧셈이 필요할 것이다. 이 때, 이렇게 복잡한 연산을 간결하게 할 수 있는 방법은 두 가지가 있다. 

- Projective coordinates
	- 한 번의 점프를 빠르게 뛰자! 라는 아이디어
	- 차원을 2차원에서 넘어서 3차원에서 연산한 후, 다시 2차원으로 돌아오는 구조
	- Affine 좌표 $(x, y)$를 Projective 좌표 $(X: Y: Z)$로 변환
		- $x = \frac{X}{Z^c}, y = \frac{Y}{Z^d}$로 서로 변환 가능
	- 장점
		- **역원 계산 제거**: Modular inverse 연산이 필요 없어서 속도가 빨라짐.
		- **연산 최적화**: ECC에서 가장 많이 쓰이는 연산인 점 덧셈과 배수 계산이 더 효율적.
	- 종류: $c, d$를 뭐로 정의할 것인지에 따라 갈림
		- **Standard Projective Coordinates**
			- $c, d = 1, 1$
		- **Jacobian Coordinates**: 특히 곱셈 연산이 많은 경우에 유리.
			- $c, d = 2, 3$
		- **Lopez-Dahab Coordinates**: 이진 곡선에서 자주 사용됨.
			- $c, d =1, 2$
- Scalar Multiplication
	- 징검다리의 개수를 줄이자! 라는 아이디어
	- Montgomery Ladder, Sliding Window 알고리즘 등이 사용됨.

### 타원곡선 암호의 구현
![[Pasted image 20250928035800.png]]
타원곡선 전자서명을 구현하기 위한 필수적인 암호 기능들을 정의한 사진이다. 이 때 큰 수의 연산 기능은 왜 들어갔냐면 위의 사진에서의  p = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F와 같은 상황에서의 연산을 구현하기 위해 필요한 것이다. 

### ECC의 핵심: domain parameters
ECC에서 가장 중요한 것은 domain parameter로, 이 타원곡선암호가 어디에서 동작할지를 정의하는 기능을 수행하며, 유한체로 치자면 $GF(p)$에서 활동할지, $GF(2^n)$에서 활동할지를 정의한다. 

샘플로 몇 가지를 가져와 보면 다음과 같다. 
![[Pasted image 20250928040342.png]]
이 사진의 **B-163, B-233**에서 보면 알 수 있듯이 이 타원곡선은 **이진 타원곡선**이라는 것을 알 수 있으며, B 뒤에 붙은 숫자가 클수록 축도 같이 커지기 때문에 보안성도 같이 상승한다 볼 수 있다. 

---
## 중요한 단어
1. 타원곡선
2. 타원곡선군
3. 타원곡선암호
4. Hasse's Inequality
5. Projective Coordinates
6. Scalar Multiplication
7. domain parameters