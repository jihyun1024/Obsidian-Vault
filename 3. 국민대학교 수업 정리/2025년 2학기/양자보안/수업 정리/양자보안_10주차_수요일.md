---
tags:
  - 암호학
  - 3학년_2학기
title:
---
## 학습 주제
1. PQC: ML-KEM vs. ML-DSA
2. PQC: Mathematical Background
3. Kyber: NTT (Mathematical Preliminaries)

---
## 연관 수업
[[양자보안_9주차_월요일]]
[[양자보안_9주차_수요일]]
[[양자보안_10주차_월요일]]

---
## 수업과 관련한 질문 3가지
1. Kyber에서 비트 반전이 필요한 이유가 무엇인지
2. Kyber의 수학적 Preliminary 중에서 $n$으로 $q-1$을 나눌 수 있다는 성질이 어떤 이점이 있는지
3. Kyber의 NTT가 Ring Isomorphism일 때 얻을 수 있는 좋은 성질이 무엇인지

---
## 강의 요약
이 앞에 있는 내용인 Kyber: Mathematical Symbol은 그냥 이런 내용이 있다 정도만 생각하고 넘어가도 별 상관이 없을 것 같다...
### PQC: ML-KEM vs. ML-DSA
![[Pasted image 20251106065936.png]]

위의 그림은 **FIPS-203(CRYSTALS-KYBER, ML-KEM)과 FIPS-204(CRYSTALS-DILITHIUM, ML-DSA)에 사용되는 수학적인 Background를 비교한 것**으로, 알고리즘 이름과 함께 그에 해당하는 안전성 또한 같이 적어놓았다. 

이 사진에서는 두 알고리즘의 공통점과 차이점을 동시에 비교한다. 둘은 같은 뿌리에서 나왔기 때문에 한 번에 배우고 있는 것이고, 어느 순간 둘을 따로 배우게 될 것이다. 

FIPS-203에서는 $R_q$에서 $q = 3329 = 2^8 \times 13 + 1$을 사용했으며, 이를 16진수로 표현하면 `0xd01 = 0b110100000001`로 나타낼 수 있다. 
반면, FIPS-204에서는 조금 다른데, FIPS-204에서는 $q = 8380417 = 2^{23} - 2^{13}+1 = 2^{13} \times (2^{10}-1) + 1 = 2^{13} \times 3 \times 11 \times 31 + 1$을 사용하며 이를 16진수로 표현하면 `0x7fe001 = 0b011111111110000000000001`로 나타낼 수 있다. 
(두 값은 기억해 두면 좋다)

둘은 전부 소수라는 공통점이 있으며, $q-1$을 각각 $2^8$ 또는 $2^{13}$으로 나눌 수 있다. 단, $2^9$ 이나 $2^{14}$으로는 나눌 수 없는데, 이는 수학적으로 중요한 성질로, 나중에 다룰 것이다. 

또한, FIPS-203은 크게 세 종류로 나눌 수 있으며, 안전도 면에서 위로 갈수록 덩치가 커서 안전하지만 공간을 많이 차지해 더 느리다는 특성이 있다. 이 때, $k, l$을 각각 4, 3, 2로 분류할 수 있다. 
이는 FIPS-204에서도 위의 사진처럼 비슷하게 고를 수 있다. 

### PQC: Mathematical Background
![[Pasted image 20251106065951.png]]
이번 사진도 아까처럼 FIPS-203과 FIPS-204에 대한 수학적인 Background를 적어서 비교한 것으로, 이번에는 **Primitive Root of Unity**, 즉, Unity=1에 대한 원시근을 각각 나타낸 것이다. 

FIPS-203에서는 primitive root로 $\zeta = 17 = 2^4 + 1$을 사용하며, FIPS-204에서는 primitive root로 $\zeta = 1753 = 2^3 \times 3 \times 73 +1$을 사용한다. 

이는 강력한 수학적인 성질을 가져다 주는데, Primitive root란 $n$번 제곱할 때 동안 $mod\ q$ 연산했을 때 1부터 $q-1$까지 모든 값을 생성하는 원소로, 대수학에서의 Cyclic group의 Generator와 비슷한 개념이다. 또한, Kyber에서는 $\frac{n}{2} = 128$번 제곱하면 3328 = -1로 떨어진다. (FIPS-204도 비슷)

이 때, 대수학을 배웠다면 primitive root란 개념은 $q-1 = 3328$번 제곱해야만 1이 나오는 거 아닌가 하고 궁금할 수 있는데, 이는 polynomial ring $R_{3329}$에서의 NTT를 위해 사용하기 위함이다. 
그러면, NTT에 대해 배워 보자. 

### Kyber: NTT (Mathematical Preliminaries)
**NTT(Number Theoretic Transform, 수론적 변환)** 은 Kyber나 Dilithium에서 중요한 개념으로, $R_q$에서 직접 다항식을 $256^2$ 번 계산하기는 매우 번거로우니 $T_q$ 공간으로 보내서 계산하고, 그 결과물을 $NTT^{-1}$ 변환을 통해 다시 $R_q$로 끌고 온다는 개념이다. 

이 변환으로 인해 계산 복잡도를 $O(n^2)$에서 $O(n\log n)$으로 낮출 수 있는 장점이 있다. 
이 때, 세 가지의 궁금한 점이 생길 수 있다. 

1. $a(x)$에서 $\hat{a}$로 바뀔 때, 어떤 모습으로 바뀌는지
2. $\hat{a} \times \hat{b} = \hat{c}$를 계산할 때, 어떻게 계산하는지
3. $\hat{c}$에서 $c(x)$로 바뀔 때, 어떻게 역변환을 계산할지

이를 위해서는 NTT 변환으로 바뀐 결과물(여기서는 $\hat{a}$의 모습)이 어떻게 생겼는지를 알아야 한다. 
다음의 사진을 보자. 

![[Pasted image 20251106074944.png]]
이 사진에서 $q-1$을 하는 이유는 원소 0을 제외시킨다면 순환군이 되어 하나의 숫자(각각 17과 1753)로 전체 원소를 나타낼 수 있기 때문이다. 

이 때, 우리는 $R_q$에서 다항식 부분에만 집중해 볼 것이다. 

$\zeta$가 $Z^*_q$ 내부의 order가 $n$인 원소라 하자. (여기서는 17) 이 때, 1부터 $n-1$까지의 홀수인 정수 $i$에 대해, **다항식 $x^2 - \zeta^i$는 $Z_q$에서 Irreducible, 즉 기약 다항식이다.**
이는 귀류법(명제의 결론이 부정이라는 것을 가정했을 때 모순되는 가정이 나온다는 것을 보여 원래 명제가 참임을 증명하는 방법)으로 증명할 수 있다. 

만약, 해당 다항식이 $Z_q$에서 기약 다항식이 아니라면, $c \in Z_q$인 해가 존재한다. 이는 $c^2 - \zeta^i = 0$이 되며, 해당 다항식을 이항하고 양변에 $n$제곱을 하면 $c^{2n} = (\zeta^i)^n = (\zeta^n)^i = 1$로 연결된다. 이 때 위에서 봤던 $\zeta^n = 1$이 사용되어 $c^{2n} = 1$이 된다. 

이제 $c^n$을 계산해 보자. $c^n = ({c^2})^{\frac{n}{2}} = (\zeta^i)^{\frac{n}{2}} = (\zeta^{\frac{n}{2}})^i = (-1)^i = -1$이다. ($i$는 홀수) 따라서, $c$의 order는 정확히 $2n$이다. **하지만,** $Z^*_q$의 크기는 $q-1$이고, $q-1$은 맨 위에서 봤듯이 $n$으로는 나누어지지만 $2n$으로는 나누어질 수 없어 order가 $2n$인 원소는 존재할 수 없다. 

따라서 위와 같이 모순이 발생하기 때문에, $x^2 - \zeta^i$는 Irreducible polynomial임을 증명할 수 있다.

이 명제와 증명이 의미하는 바는 $R_q$에서 $T_q$로 넘어갈 때, $R_q$에서는 칸이 256개였고, 각각의 칸이 $x^n + 1$이라는 다항식 하나에 의해 통제되었다면, $T_q$에서는 칸이 128개가 존재하고, 각각의 칸은 $x^2 - \zeta^i$라는 다항식(단, $i$는 홀수)들에 의해 각각 통제된다는 것을 의미한다. 
![[Pasted image 20251106095625.png]]

---
## 중요한 단어
1. ML-KEM vs. ML-DSA
2. Primitive Root of Unity
3. NTT (Number Theoretic Transform)
4. Irreducible Polynomial using Odd Exponents and Its Proof
