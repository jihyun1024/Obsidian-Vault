---
title: 리버스 엔지니어링 기드라(Ghidra) 실전 가이드
author: 나카지마 쇼타, 고타케 다이치, 하라 히로아키, 가와바타 고헤이
category: 리버스 엔지니어링
publishDate: 2022-01-11
coverUrl: https://product.kyobobook.co.kr/detail/S000001810465
tags:
  - 도서
---
# 기초 편
[[리버스 엔지니어링 입문]]
[[기드라 입문]]
[[Ghidra를 이용한 리버스 엔지니어링 연습]]
[[Ghidra Script&Extension으로 기능 확장]]

# 실전 편
[[Ghidra vs. Crackme - ELF 크랙미 분석]]
[[Ghidra vs. MOTHRA - 윈도우 백도어 분석]]
[[Ghidra vs. BlackBicorn - 윈도우 패커 분석]]
[[Ghidra vs. Godzilla Loader - 윈도우 멀웨어 분석]]
[[Ghidra vs. SafeSpy - 안드로이드 앱 분석]]

# 부록
[[부록(리버스 엔지니어링 기드라 실전 가이드)|기초 편, 실전 편에서 다루지 않았던 기드라 응용 기능과 더불어 리버스 엔지니어링에 도움 되는 Ghidra Script 소개, 한국어판 특별 부록으로 CTF 형식의 문제를 실제로 풀어볼 수 있는 부록 추가]] 

---
# 실습 환경 설정
### 예제 소스 다운로드
예제 소스 다운로드 URL: https://www.hanbit.co.kr/src/10507

예제 프로그램은 GZF (기드라 데이터베이스 파일), PE (윈도우 실행 파일), ELF (리눅스 실행 파일), APK (안드로이드 실행 파일)를 포함하고 있다. 이들 파일은 실행해도 실행 단말기나 외부 단말기에 악영향을 주지 않도록 조치되어 있지만, 실제 악성코드가 일부 포함된 파일도 있기 때문에 백신 소프트웨어에 의해 검출될 가능성이 있다. 
따라서 가상 환경을 구축하고 가상 환경 안에서 파일을 분석하는 것을 권장한다. 

### 파일 압축 해제
다운로드한 zip 파일을 압축 해제하고 스크립트 경로를 설정한 상태에서 실행할 것이다. 
1. C:\Ghidra 디렉터리 설정
2. C:\Ghidra 디렉터리 안에 ghidr_practical_guide.zip 파일 압축 해제
3. ghidra_practical_guide에 포함된 디렉터리 확인

이를 Ghidra Script 경로에 추가한다. 
1. 기드라 실행 후 녹색 용 모양의 아이콘을 클릭해 CodeBrowser 부팅
2. 메뉴에서 Window - Script Manager 선택
3. Script Manager 메뉴의 오른쪽 끝에 있는 항목 아이콘 클릭 > Bundle Manager 선택
4. Bundle Manager의 + 버튼 클릭 > C:\Ghidra\ghidra_scripts 추가

### 분석 환경 구축
기본 분석 환경은 Windows이지만 5장에서는 리눅스 환경이 필요하다. Windows에는 리눅스용 윈도우 하위 시스템인 WSL이 있으니 이를 활용하면 된다. WSL은 다음과 같이 설정한다. 
1. 시작 버튼 우클릭 > 앱 및 기능 클릭
2. 관련 설정의 프로그램 및 기능 클릭
3. 왼쪽 목록에서 Windows 기능 켜기/끄기 버튼 클릭
4. Linux용 Windows 하위 시스템 박스 체크 > 확인을 눌러 설치하고 다시 시작
5. Microsoft Store 앱을 열고 Ubuntu로 검색하여 Ubuntu LTS 설치
6. Ubuntu LTS를 실행하여 리눅스에서 사용할 사용자명과 비밀번호 설정

WSL에서는 /mnt/c에 C 드라이브가 마운트 되기 때문에 C:\Ghidra에 접근하기 위해서는 /mnt/c/Ghidra로 경로를 설정해야 한다. 
또는 실제 리눅스 환경이나 가상 머신을 준비해 이용해도 상관없다. 단, 가상 머신을 이용해 가상 환경을 일일히 구축하는 것은 툴을 설치하거나 환경설정을 하는 등의 작업이 대부분이기 때문에 번거로워서, FireEye 社가 공개하고 있는 FLARE VM이라는 툴을 사용하면 멀웨어 분석과 관련 있는 툴 세트가 자동으로 설치되므로 편리하다. (단, Ghidra는 따로 업데이트하자.)