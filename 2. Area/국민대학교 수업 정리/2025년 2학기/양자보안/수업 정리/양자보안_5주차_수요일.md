---
tags:
  - 수업_정리
  - 암호학
---
## 학습 주제
1. ECC in Bitcoin? secp256k1
2. 타원곡선? vs. 타원곡선군? vs. 타원곡선암호
3. 타원곡선 연산 최적화: (k, P) -> kP

---
## 연관 수업
[[양자보안_4주차_월요일]]
[[양자보안_4주차_수요일]]
[[양자보안_5주차_월요일]]

---
## 수업과 관련한 질문 3가지
1. Hasse's Inequality가 타원곡선암호에서 의미하는 바가 어떤 것인지
2. ECC의 연산 최적화에서 Projective Coordinates가 실제 암호 구현 레벨에 어떻게 동작하는지
3. 56 page에서 Cryptographic Standards 그림 옆에 왜 Social Consensus가 붙어 있는지

---
## 강의 요약
이번 시간에는 4주차 수요일 수업에서 내가 셀프로 정리했던 ECC에 대해 자세하게 알아본다. 
### ECC in Bitcoin? secp256k1
먼저 Bitcoin에서 사용되는 타원곡선암호인 **secp256k1**에 대해 알아보자. secp256k1의 이름에서 알 수 있는 것은 보안강도, 사용하는 타원곡선의 종류를 알 수 있다. 

먼저 보안강도는 256으로, 실제 보안 강도는 128bit급 보안강도를 보장한다. 그 다음으로 k란 문자는 Koblitz Curve를 의미하며, Koblitz라는 사람이 제안한 곡선을 사용한다.

![[Pasted image 20251003185654.png]]
그렇다면, 위에서 타원곡선의 parameter를 살펴보면서 2가지 의문점이 들 수 있다. 
1. $2^{256}$과 $2^{32}$와의 지수승의 차이가 왜 이렇게 크게 나는가?
2. 왜 $a$를 0으로 설정하는가?

이에 대한 정답은 Bitcoin에서의 효율적인, 즉 빠른 연산과 관련이 있다. 
매우 안전한 ECC를 쓴다면 그만큼 안전하지만, 동시에 속도는 그에 비례해서 떨어질 수 있다. 이는 고급암호학및응용 수업에서 내가 계산해 봤던 것과 마찬가지로 타원곡선의 식에 $a$만 없어도 계산량이 확 줄어드는 것을 확인할 수 있었다. 

따라서, $a,b$ 둘다 256bit의 수를 사용하지만, 간단하게 각각 0과 7로 설정하는 것이고, $F_p$ , 즉 유한체에서 2의 지수승에서의 차이도 $2^{256}$은 256bit를 써야 해서 필수로 설정하고 그 외에는 바로 $2^{32}$로 확 떨어뜨려 계산의 속도를 빠르게 한다. 

따라서, secp256k1의 parameter들 중 $p, a, b$는 타원곡선 자체를 정의하는 것이다. 
그리고, 남은 $G, n, h$는 각각 기저점(Base point), order, cofactor를 정의한다. 

$G$에서 compressed form과 uncompressed form이 왜 있을까?
기저점 $G$를 나타낼 때, $x$좌표 256bit, $y$좌표 256bit씩 총 512bit를 써야 한다. 그런데, 수식을 보면 $y^2 = x^3 + 7\ (mod\ p)$로 타원곡선의 식을 나타낼 수 있고, 이는 $x$좌표만 주면 $y$좌표는 부호 비트만 1비트 따로 주면 정확히 계산해 낼 수 있다. 이 때문에 compressed form으로 짧게 나타낼 수 있다.

### 타원곡선? vs. 타원곡선군? vs. 타원곡선암호
이 제목은 ECC 정리하면서 진짜 많이 보는 것 같다... 지겨워도 중요한 내용일 테니 정리해 보자. 

![[Pasted image 20251003193847.png]]
타원곡선을 공부하며 타원곡선에 존재하는 점의 수를 어떻게 판단할 수 있는지 궁금한 적이 있었다. 이 때 **Hasse's Inequailty**는 타원곡선암호에서 유한체 위의 타원곡선에 존재하는 점의 개수를 추정할 수 있는 핵심적인 수학적 도구이다. 이 부등식은 암호의 안전성과 효율성을 결정하는 데 중요한 역할을 한다. 

사진에서도 써 놨듯이, $\#E(F_q)$는 유한체 $F_q$로 정의된 바둑판 위의 점의 개수이며, 이는 $q+1-2\sqrt{q}$와 $q+1+2\sqrt{q}$ 사이의 값이다. 이는 너무 적지도, 너무 많지도 않게 점들이 존재한다는 의미이며, 전체적인 크기는 $q$가 압도적이기 때문에 $q$가 결정하게 된다. 

이 부등식이 중요한 이유는 여러 가지가 있다. 
1. ECC의 보안성 확보: ECC의 보안은 ECDLP의 어려움에 기반한다. 이 때 Hasse's Inequality는 점의 수, 즉 공격자 입장에서는 선택지가 너무 작지 않도록 = 풀기 어렵도록 보장한다. 
2. 효율적인 키 생성: ECC에 사용할 타원곡선을 선택할 때, 적절한 개수의 점을 가진 곡선을 고르는 기준이 되어 너무 약한 곡선을 피할 수 있다. 
3. 알고리즘 최적화: 뒤에서 다룰 ECC의 핵심 연산인 Scalar Multiplication 등은 크기에 따라 성능이 달라지기 때문에 점의 수를 예측할 수 있다면 구현 효율이 높아진다. 

그러면, $q$가 1억쯤 되어서 그 만큼의 덧셈을 실행해야 한다면, 어떨까? 아마 매우 오래 걸릴 것이다. 이를 위해 **타원곡선의 연산 최적화**가 필요하다.

### 타원곡선 연산 최적화: (k, P) -> kP
![[Pasted image 20251003195225.png]]
타원곡선 연산 최적화에 사용되는 **Projective Coordinates**와 **Scalar Multiplication**은 단지 ECC에서만 사용되지 않고 RSA, DSA, DH 등의 다양한 암호 알고리즘에서 사용된다. 

이 두 알고리즘의 목표는 타원곡선을 기준으로 설명했을 때, 점 $P$와 더해야 하는 횟수 $k$가 주어졌을 때, $kP$를 빠르게 계산하는 것이다. 이를 위의 사진처럼 한강에서 징검다리를 건너는 것으로 비유하면, 두 가지 방법이 있다. 

1. 점프력 자체를 높여서 한 번에 많이 뛴다 (Projective Coordinates)
2. 징검다리의 개수를 줄여서 1개씩 뛸 것을 10개씩 뛴다 (Scalar Multiplication)

설명으로만 들어 보면 그게 그거 같지만, 수학적으로는 큰 차이가 있다.
먼저, Projective Coordinates는 2차원에서 3차원으로 올라가서 연산하는 원리를 사용하며, 이를 사용하면 웜홀을 타는 것과 비슷하게 계산을 확 줄일 수 있다. 이는 $x, y$축 뿐만 아니라 $z$축까지 사용하는 것과 비슷하며 3차원에서의 점의 좌표는 $(X : Y:Z)$로 표시한다. 

한편, Scalar Multiplication은 L2R Binary Method 등을 사용해 덧셈을 곱셈처럼 변환하여 수행하는 원리를 사용한다. 다만, 이 알고리즘에는 연산력이 많이 필요한데, IoT 기기의 경우에는 크기가 작아 연산력이 딸리기 때문에 구현에 어려움이 있다. 따라서, 이걸 구현하는 게 전문가의 영역이라고 할 수 있다. 

---
## 중요한 단어
1. secp256k1
2. Hasse's Inequality
3. Projective Coordinates
4. Scalar Multiplication
