---
tags:
  - 일일_노트
  - 수업_정리
---
## 학습 주제
1. TCP/IP 프로토콜 동작 원리와 구조
2. 소켓의 기본 개념

---
## 이전 수업
없음

----
## 강의 요약
이 강에서는 하나의 프로그램이 네트워크 상에서 다른 프로그램과 어떻게 통신하는지를 알기 위해 C언어의 맥락에서 이해할 수 있도록 시작선상에서부터 출발하며, 궁극적으로 소켓(Socket)이라 알려진 API(Application Program Interface)를 학습하고 이를 통해 네트워크 프로그래밍을 구현할 예정이다. 
### TCP/IP 프로토콜 동작 원리
인터넷은 다음의 사진으로 간단하게 요약할 수 있다. ![[Pasted image 20250918033927.png|400x300]] 
- 호스트 = 컴퓨터: 최종 사용자로, 응용 프로그램을 수행하는 주체
- 라우터: 호스트는 라우터에 연결되어 있어야 함
	- 호스트에서 생성된 데이터를 여러 네트워크를 거쳐 전송하여 서로 다른 네트워크에 속한 호스트 간 통신을 가능하게 하는 장비
	- 일반적으로 응용 프로그램은 라우터의 존재를 모른다.
	
- 통신 프로토콜
	- 호스트-라우터, 라우터-라우터, 호스트-호스트 간 통신하기 위한 정해진 절차, 방법, 메시지 형식 등을 정의한 것
	- 예시: 부모님이나 교수님께 편지를 쓰기 위한 형식, 종교에서 기도에 대한 형식 등

#### TCP/IP 프로토콜
인터넷의 핵심 프로토콜인 TCP와 IP를 비롯한 각종 프로토콜은 **운영체제의 일부로 구현되며,** 응용 프로그램은 운영체제가 제공하는 TCP/IP 프로토콜의 서비스를 사용해 통신한다. 

TCP/IP 프로토콜은 Application, Transportation, Internet, Network access 계층의 4계층으로 이루어져 있으며, 각각의 계층은 특정 서비스를 제공하고, 서로 다른 프로토콜을 사용해 데이터 전송을 담당한다. ![[Pasted image 20250918042525.png]]

- 네트워크 접근 계층
	- 실제 네트워크 접근 계층은 1계층인 물리 계층(Physical Layer)과 2계층인 데이터 링크 계층(Data Link Layer)로 구성된다.
	- 물리 계층: 0과 1의 비트열을 전기적/광/무선 신호 등으로 변환해 물리적인 매체(케이블, 전파 등)를 이용해 전송한다. 
	- 데이터 링크 계층: 1계층에서 온 신호를 프레임 단위로 관리하면서 오류 검출, 흐름 제어, 주소 지정 기능을 제공한다. 또한, **MAC 주소**를 통해 ==같은 네트워크의== 수많은 호스트들 중 정확하게 누구에게 데이터를 보낼지 결정한다. 
	
- 인터넷 계층
	- 네트워크 접근 계층의 도움을 받아 데이터를 목적지 호스트까지 전달한다. 
	- **라우팅**을 통해 ==다른 네트워크의 호스트와도 통신할 수 있다.==
	- IP 주소와 라우터로 구성된다. 
	- 주소 지정 방식
		- IP 주소: SW적으로 정의된 논리적 주소로, 전 세계적인 유일성과 하드웨어 독립성을 가진다. 
		- 라우터: 데이터를 목적지까지 전달하는 일련의 작업으로, 라우팅에 필요한 정보 수집 및 라우팅 정보를 기반으로 데이터를 전달한다. 
	
- 전송 계층
	- 최종 통신 목적지(응용 프로그램)를 지정, 오류 없이 데이터를 전송하는 계층이다. 
	- 주소 지정 방식: 포트 번호
	- 대표 프로토콜: TCP, UDP
		![[Pasted image 20250918043653.png]]
		- 위에서 볼 수 있듯, TCP는 하는 일이 많지만 그만큼 안전하다고 볼 수 있다.
	
- 응용 계층
	- 전송 계층을 기반으로 한 다수의 프로토콜과 이 프로토콜을 사용하는 응용 프로그램을 포괄한다. 
	- 대표 프로토콜: HTTP, FTP, SMTP, Telnet 등등

#### 데이터 전송 원리
패킷이란 각 프로토콜에서 정의한 제어 정보(IP 주소, 포트 번호, 오류 체크 코드 등)와 데이터를 포괄하는 개념으로, 제어 정보의 위치에 따라 앞쪽에 붙는 헤더와 뒤쪽에 붙는 트레일러로 패킷의 구성 요소를 구분할 수 있다. 

(송신측과 수신측을 차례로 나타낸 것)
![[Pasted image 20250918044445.png|350x150]]![[Pasted image 20250918044643.png|350x150]]
송신측의 경우, 위와 같은 형태로 패킷이 상대방에게 전송되며, 상대방은 그 반대로 헤더와 트레일러를 한 겹씩 벗겨내 데이터를 얻게 된다. 

이 때 계층별로 각 계층은 동일 위치의 상대 계층과 통신하는 것으로 간주한다. 즉, IP 헤더를 벗겨낼 수 있는 것은 같은 IP 프로토콜을 사용하는 인터넷 계층이다. 

패킷의 전송 형태의 경우는 다음과 같다. 
- 응용 계층, 전송 계층: 하부 계층이 제공하는 가상적인 연결을 사용해 동작
- 인터넷 계층: IP 주소와 라우팅 기능을 활용해 패킷 전송 경로 결정
- 네트워크 접근 계층: 물리 주소를 사용해 실제 패킷 전송
![[Pasted image 20250918045200.png]]
즉, 응용계층은 실제로는 수많은 라우터, 스위치, 무선 링크를 통해 데이터가 이동하더라도, **두 응용 프로세스 사이에 직접적인 통신선이 있는 것처럼 생각하고 동작한다.**

#### IP 주소, 포트 번호
- IP 주소
	- 인터넷에 있는 호스트와 라우터 각각의 식별자로, IP를 공유하거나 폐쇄된 네트워크가 아니라면 전 세계적으로 값이 유일하다.
	- IPv4는 32bit, IPv6는 128bit를 사용한다. 
	- IPv4는 8bit 단위로 점호