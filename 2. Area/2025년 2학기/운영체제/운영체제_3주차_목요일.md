---
tags:
  - 일일_노트
  - 수업_정리
---
## 학습 주제
1. Interprocess Communication
2. Producer-Consumer Problem
3. Shared Memory
4. Message Passing
5. Examples of IPC Systems
6. Communications in Client-Server Systems

---
## 이전 수업
[[운영체제_2주차_목요일]]
[[운영체제_3주차_화요일]]

---
## 강의 요약
이번에는 프로세스 1, 2강에 이어 마지막인 프로세스 3강이다.

### Interprocess Communication
프로세스는 다른 프로세스들과 상호작용, 즉 데이터를 share하는지에 따라 independent한 process와 cooperating한 process로 분류할 수 있다. 이 중 우리가 다룰 것은 cooperating process로, 보통의 컴퓨터에서 cooperating process를 사용하는 이유는 다음과 같다. 
1. 프로세스 간 정보의 쉬운 공유
2. 컴퓨터 연산의 속도 증가
3. 모듈화의 용이함
4. 편리함

Cooperating process들은 IPC(InterProcess Communication) 메커니즘이 필요하며, 이는 데이터를 process들끼리 서로 주고받는 작업을 할 수 있도록 한다. 

IPC의 종류는 크게 Shared Memory, Message Passing 두 가지로 나눠진다.

### Producer-Consumer Problem
Cooperating process들은 Producer 프로세스가 정보를 생산하고 Consumer 프로세스가 정보를 소비하는 방식으로 이루어진다. 

더 자세하게 말하면, producer와 consumer 프로세스들이 메모리 공간을 공유할 때, 두 프로세스가 전부 제대로 동작하기 위해서 버퍼가 필요하며, producer는 버퍼를 채우고, consumer는 버퍼를 비우는 역할을 한다. 

이 때 버퍼의 종류는 두 종류가 있는데, **unbounded-buffer**와 **bounded-buffer**로, 
- unbounded-buffer: 버퍼의 크기에 제한 없이 동적할당으로 무한정 버퍼를 할당할 수 있다. 
	- Producer: 기다리지 않고 계속 데이터를 채울 수 있다. 
	- Consumer: 소비할 데이터가 없다면 기다린다.
- bounded-buffer: fix된 버퍼의 크기가 있다 가정하며, 
	- Producer: 버퍼의 모든 공간이 다 차면 기다린다.
	- Consumer: 소비할 데이터가 없다면 기다린다. 
실제 시스템에서는 bounded-buffer 모델을 더 많이 사용하고, 이는 프로그래밍 관점에서 Circular array(원형 배열)로 구현할 수 있다. 

```cpp
#define BUFFER_SIZE 10

typedef struct {
	...
} item;

item buffer[BUFFER_SIZE];
int in = 0;
int out = 0;
```
만약 `in == out`이라면, buffer는 빈 것이며, `(in + 1) % BUFFER_SIZE == out`이라면 buffer는 꽉 찬 것으로 간주한다.

```cpp
item next_produced;

while (true) {
	while (((in + 1) % BUFFER_SIZE) == out)
	 /* do nothing */
	 
	buffer[in] = next_produced;  // 실행할 것을 버퍼에 넣음
	in = (in + 1) % BUFFER_SIZE; // in을 1 증가
}
```
producer process의 경우, 이 코드의 흐름처럼 동작하며, 두 번째 while문은 `in`이 `out` 바로 전까지 온 상황으로, 버퍼가 꽉 찬 상태이기 때문에 더 이상 뭔가를 할 수 없다. 

```cpp
item next_consumed;

while (true) {
	while (in == out) 
		/* do nothing */
		
	next_consumed = buffer[out];   // 버퍼에서 실행할 것을 빼 옴
	out = (out + 1) % BUFFER_SIZE; // out을 1 증가
}
```
consumer process의 경우는 이 코드처럼 동작하며, 두 번째 while문은 `in`과 `out`이 만나는 상황으로, `out`이 1씩 늘어가다 `in`과 만나 버퍼가 비어있기 때문에 이 상태에서도 뭔가를 할 수 없다.

### Shared Memory
Shared Memory 기법은 메모리의 일정 부분을 프로세스들이 서로 공유하는 것으로, Shared Memory에 접근하고, 이를 다루는 코드 부분은 개발자들에 의해 명시적으로 있어야 한다. 

그 이유는 Shared Memory 부분은 OS에 내장되어 있지 않아 프로그램마다 따로따로 관리를 해줘야 하기 때문이다.

### Message Passing

### Examples of IPC Systems

### Communications in Client-Server Systems


---
## 중요한 단어
1. IPC(InterProcess Communication)
2. Cooperating process
3. Producer-Consumer Problem