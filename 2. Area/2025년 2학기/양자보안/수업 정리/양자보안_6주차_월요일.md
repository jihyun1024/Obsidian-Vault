---
tags:
  - 수업_정리
  - 암호학
---
## 학습 주제
1. 타원곡선? vs. 타원곡선군? vs. 타원곡선암호
2. 타원곡선 연산 최적화: (k, P) -> kP
3. 국내외 공개키 암호 알고리즘 분류
4. 수학적 배경: 타원곡선 암호의 구조
5. 수학적 배경: 유한체

---
## 연관 수업
[[양자보안_4주차_월요일]]
[[양자보안_4주차_수요일]]
[[양자보안_5주차_월요일]]
[[양자보안_5주차_수요일]]

---
## 수업과 관련한 질문 3가지
1. 양자컴퓨터의 qubit 수가 많아지면 어떤 연산 능력이 향상되는지
2. 2번째 교재 52 page에서 A1, A2, ... , M6, M7 등이 뭘 의미하는지
3. Shor's algorithm을 어떻게 구현할 수 있는지 

---
## 강의 요약
이번 강의에서도 타원곡선 암호에 대해 배운다. 그만큼 타원곡선 암호가 이 수업에서 중요하다는 의미로 받아들이고 열심히 공부하면 될 것 같다. 
### 타원곡선? vs. 타원곡선군? vs. 타원곡선암호
ECC, 즉 타원곡선암호에서 중요하게 봐야 하는 것은 다음 3가지가 있다: 
1. 기반이 되는 유한체
2. 타원곡선 식
3. 기저점(Base Point)

이 중 제일 중요한 것은 바로 기반이 되는 **유한체**로, 수학적으로 완벽한 구조를 이루면서 타원곡선 암호에서 격자점들의 개수 또한 결정한다. 

예를 들어 $F_{23}$이라는 유한체가 있다고 하자. 이 경우, 개인키는 2에서부터 23까지의 경우 중에서 하나를 고를 수 있으며, Alice가 17을 선택할 경우, Alice의 개인키는 17이 되어 17과 Base Point $G$를 알고 있는 상태에서는 쉽게 $17G$를 계산하여 그 결과를 공개 정보로 설정한다. 

그러나, 17을 모르고 있는 상태에서는 $17G$로부터 개인키인 17을 역으로 알아내는 것이 매우 어렵기 때문에(ECDLP, 타원곡선 이산대수문제), 이를 통해 전자서명이나 키교환(ECDSA, ECDH) 등의 타원곡선암호 알고리즘을 구현할 수 있다. 

### 타원곡선 연산 최적화: (k, P) -> kP
Hasse's Inequality로 인해 유한체의 크기가 커질수록 그에 비례해 개인키의 선택지 또한 넓어지므로 유한체가 커질수록 해당 ECC는 안전하다. 그러나, 개인키의 선택지, 즉 크기가 커질수록 계산 속도는 떨어지며, 해당 점을 저장하는 데 필요한 공간 또한 커지기 때문에 비용 부담 또한 커진다.

예를 들어, 256bit급의 ECC를 사용한다면 한 점 $(x, y)$를 표현하는 데 256bit가 사용된다. 이는 ECC의 수많은 연산들을 수행하며 256bit를 항상 달고 다녀야 하기 때문에 컴퓨터에는 상당한 부담을 주게 된다. 따라서, 컴퓨터의 부담을 줄이기 위해 연산 최적화가 필수적이다. 

>만약 은행 결제가 버튼 1번 눌렀을 뿐인데 1분 이상 암호 연산에 소모된다면 최악의 경험을 하게 될 것이다....

이는 거의 모든 공개키 암호 알고리즘에도 적용되는 것으로, 각 알고리즘마다 목표가 있다. 
- ECDSA, ECDH: $k, P$가 주어졌을 때 $kP$를 어떻게 빠르게 계산할 것인가?
- DH: $a, g, p$가 주어졌을 때 $g^a \ (mod \ p)$를 어떻게 빠르게 계산할 것인가? 
- RSA: $C, d$가 주어졌을 때 $C^d \ (mod\ n)$을 어떻게 빠르게 계산할 것인가? 

이 중에서 우리는 ECC에 대해서만 알아볼 것이다. 

ECC에 해당하는 목표를 달성하기 위한 방법으로는 두 가지가 있다. 100, P가 주어졌을 때, 

1. Projective Coordinates
	- 한 번의 덧셈을 빠르게 하는 방법
	- 2차원에서 3차원으로 올라가서 연산하는 방법으로, 좌표를 3개 사용한다. 
2. Scalar Multiplication
	- 전체 결과를 빠르게 구하는 방법
	- 타원곡선 덧셈의 횟수 자체를 줄이는 방법이다. 

Projective Coordinates와 Scalar Multiplication 둘 다 사용해서 타원곡선 덧셈 한 번당 걸리는 시간도 줄이고, 타원곡선 덧셈의 횟수 자체도 줄이는 경우가 가장 이상적인 경우라 할 수 있다. 

### 국내외 공개키 암호 알고리즘 분류
국내외 공개키 암호 알고리즘은 다음과 같이 분류된다. (출처: 2018년도 KISA 안내서)
![[Pasted image 20251007085605.png]]
- (암): 메시지 암복호화 용도
- (전): 전자서명 용도
- (키): 키 공유(키 교환) 용도

이 표에서 볼 수 있듯이, 대부분의 국가가 인수분해 문제를 사용한 암호는 RSA를 사용하고, 이산대수 문제를 사용한 암호는 DH나 DSA를, 타원곡선 문제를 사용한 암호는 ECDSA, ECDH를 사용하기 때문에 여기에서 오는 딜레마 또한 **어떻게 연산 최적화를 구현할지**에 해당할 수 밖에 없다. 

### 수학적 배경: 타원곡선 암호의 구조
![[Pasted image 20251007090014.png]]
6주차 월요일 수업 필기이다. 천천히 분석해 보자. 

먼저, 가장 위에 있는 "Protocols"는 우리가 최종적으로 구현할 대상이 되는 암호 알고리즘으로, ECDH, ECDSA 등의 타원곡선 암호 알고리즘에 해당한다. 

그렇지만, 이 알고리즘들은 손가락 한 번 딸깍한다고 해서 구현되는 알고리즘이 아니기 때문에 그 밑의 단을 자세히 알아야 한다. 

바로 밑에 있는 "Point multiplication"은 주어진 $k, P$로부터 $kP$를 계산하는 과정으로, 타원곡선 이산대수문제의 기반이 되는 연산이라 할 수 있다. 이 연산은 위에서도 살펴봤었지만, Scalar Multiplication 알고리즘으로 최적화 할 수 있다.

그렇지만, $kP$는 점 $P$를 $k$번 더한 연산이기 때문에 결국은 타원곡선 점 덧셈 연산이나 2배 연산에 대해 우선 알아야 한다. 고급암호학에서 타원곡선암호에 대해 처음 배웠을 때 그랬던 것처럼, 점 덧셈 연산과 2배 연산은 아예 공식 자체가 다르며 이 두 연산은 Projective Coordinates 알고리즘으로 최적화 할 수 있다.

타원곡선에서 점 덧셈 연산은 단순한 초등학생 수준의 사칙연산이 아니라 유한체 내에서 이루어지는 연산이다. 따라서, 타원곡선 덧셈 연산을 알기 위해서는 유한체 연산을 잘 알아야 한다. 

**따라서, 전체적으로는 유한체 연산이 모여서 점이 움직이고, 그 점의 움직임이 모여 Point multiplication이 완성, 그 외의 자잘한 연산들이 모여 Protocol이 완성되는 것을 볼 수 있다.**


*그렇다면, 은행 앱에서 실제 타원곡선암호를 사용한다 가정할 때, 어떤 암호 기능들이 필수로 구현되어야 할까?*

정답은 밑의 필기와 같다. 
![[Pasted image 20251007091217.png]]
먼저, 타원곡선들의 점은 유한체에서 정의되며, 어떤 컴퓨터도 유한체 연산 기능은 구현해 놓지 않았기 때문에 **유한체 연산기**의 구현이 가장 필수로 필요하다. 

그 다음은 이와 연관되는 **타원곡선 연산기**와 **큰 수의 사칙연산기**로, 타원곡선 연산기는 유한체 연산기를 기반으로 점 $P$와 스칼라 $k$가 주어질 때 이를 타원곡선군의 성질을 이용해 계산한다. 

큰 수의 사칙연산기가 필요한 이유는 ECC의 좌표값은 256bit급의 경우 점 하나를 나타내는 데 256bit가 필요하며, 이 수는 상당히 큰 수이기 때문에 끽해야 64bit까지만 사칙연산 가능한 컴퓨터의 연산기로는 부족하고, 이런 큰 수의 사칙연산기가 필요하다. 

그 다음으로는 **양자난수발생기**인데, 이는 연산을 위해서 보다는 암호 알고리즘 동작 중 생각보다 많은 양의 난수가 필요한 순간에서 안전한 난수를 뽑아내기 위해 필요하다. 
사실, 노트북이나 컴퓨터, 서버 등 난수를 뽑을 수 있는 리소스가 많다면 크게 상관없지만, IoT 장비 등의 리소스가 부족한 환경에서는 난수를 쉽게 뽑아낼 수 없어 자칫 취약할 수 있는데, 이를 위해 리소스가 부족한 상황에서도 심장부(서버, 컴퓨터, 노트북 등)와 비슷한 수준의 난수를 생성하기 위해 양자난수발생기의 구현이 필요하다. 

이 세 가지를 전부 구현해야 드디어 **타원곡선 전자서명 연산기**를 구현할 수 있다. 

### 수학적 배경: 유한체
유한체는 ECC, PQC 등 어려운 수학적 배경을 가지고 있는 암호 알고리즘에서 많이 사용된다. 

유한체의 장점은 다음과 같다. 
1. 수학적으로 예상되는 결과를 매번 도출한다. 
2. 원소의 개수가 유한개라 컴퓨터에서 잘 돌아간다. 
3. 컴퓨터의 구조와 매우 잘 맞는다. 

![[Pasted image 20251007092317.png]]
Group(군)에서부터 Field(체)까지 이어지는 과정을 간단하게 표현한 그림이다. 

여기서 'A'와 'M'으로 시작하는 성질들이 보이는데, A는 Addition의 약자, M은 Multiplication의 약자로 Group은 덧셈만 존재하지만 Field는 덧셈과 곱셈 두 가지의 옵션을 모두 가져야 한다. 

주의할 점은, 여기서는 유한체만 다루지 무한체는 다루지 않는다. 

---
## 중요한 단어
1. 유한체
2. 타원곡선 연산 최적화
3. 타원곡선 암호의 구조
4. 유한체 연산기
5. 타원곡선 연산기
6. 양자난수생성기
7. 큰 수의 사칙연산기
8. 타원곡선 전자서명 연산기