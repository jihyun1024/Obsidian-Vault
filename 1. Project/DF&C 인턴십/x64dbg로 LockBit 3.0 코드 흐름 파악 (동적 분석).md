## 동작 분석 Warm-Up
x64dbg에 랜섬웨어를 물려 놓고 F9 키를 여러 번 누르면 [[함수 프롤로그 & 에필로그|함수 프롤로그]]를 발견할 수 있다. 

`다음을 찾기 > 모든 모듈 > 모듈간 호출`로 `Crypt`가 들어가는 암호화 관련 함수를 찾아보려 했으나, 유의미한 결과가 나오지 않아 랜섬웨어 관련 핵심 함수에 뭔가 난독화 같은 게 적용되었다고 추측할 수 있었다. 
![[Pasted image 20251030173054.png]]
이는 DLL(Dynamic Link Library) 파일의 사용을 봐도 알 수 있듯이, 암호화 관련 DLL은 딱히 정의되지 않았던 것을 확인할 수 있다. 

반면, `File`로 필터링한 결과는 다음과 같이 정상적으로 나오기에 이 파일은 암호화 관련 함수, DLL 등 정적 분석에서 확인할 수 있는 것을 난독화하여 안티 바이러스 엔진을 회피한다. 
따라서, 랜섬웨어를 정상적으로 작동시키기 위해서는 **악성 행위 이전에 난독화를 해제하는 코드가 있을 것이라 예측할 수 있다.**

x32dbg 대신 x64dbg를 사용했기 때문에 전반적으로 뭔가 [[Ragnar Locker 랜섬웨어 분석]] 때보다 exe 파일 뒤의 숫자가 더 길어진 것을 확인할 수 있다. 
```assembly
sub rsp, 28
call lockbit.7FF7D30D0BC4
add rsp, 28
jmp lockbit.7FF7D30D06E0
```
(앞으로는 `lockbit.` 뒤의 중복되는 것은 생략하던가 해야겠다. 아마 `7FF7D3` 부분)
이제 해당 function call 또는 system call 지점에 중단점을 찍고, 한 줄씩 내려가면서 분석해 보자. 

## 메인 함수 분석
(추후에 내용을 채워넣자)

---
## 더 자세하고 추가적인 분석
[[LockBit 3.0 파일 암호화 알고리즘 파악]]
[[LockBit 3.0 랜섬웨어 복호화]]