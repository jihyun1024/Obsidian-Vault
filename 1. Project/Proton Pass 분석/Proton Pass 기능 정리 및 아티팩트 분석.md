### 기능 정리
![[Pasted image 20250724104124.png]]
먼저, 위의 사진에서 보이듯이 약한 비밀번호를 보여 주고, 이를 보호하기 위해 강한 비밀번호를 사용하라고 조언해 주는 기능이 존재했으며, 재사용된 비밀번호를 보여주는 기능 또한 존재한다. 
그리고 다른 기기에서 해당 계정에 로그인 할 때, 핸드폰 번호로 일일히 문자로 PIN을 보내 주는 것이 아닌 앱에서 PIN을 확인해서 해당 PIN으로 로그인 안전성을 검증할 수 있는 2단계 인증을 지원한다. 

![[Pasted image 20250724104407.png]]
또한, 프로필 창으로 들어가면 Proton Pass 애플리케이션을 시작할 때 잠금 기능을 사용할 수 있으며, 이는 PIN으로 설정할 수 있었다. 
자동 완성 기능이라고 해서 로그인 시 사용자의 이름과 비밀번호를 Google에서 지원하는 기능처럼 자동으로 채워 주는 기능을 지원하며, 설정에 들어가면 앱에서 스크린샷을 찍는 것을 허용할지, 사용자 이름 입력란을 항상 표시할지, 자동 완성 기능을 항상 사용할지 등을 설정할 수 있었다. 
또한, [[비밀번호 관리자 애플리케이션 메인 문서|비밀번호 뭐였지 애플리케이션]] 처럼 데이터 가져오기 및 내보내기 기능을 지원한다.
### 타입별 아티팩트 쌓기
Proton Pass에서는 무료로 사용하는지, 유료로 멤버십을 가입하고 사용하는지에 따라 저장할 수 있는 정보의 범위가 달라진다. 무료로 애플리케이션을 사용하면 로그인 정보, PIN 번호, 메모, Personal Information 만을 저장할 수 있지만, 유료인 멤버십을 적용하면 그 외의 신용카드 정보, 계좌 번호, 여권 정보, Wi-Fi 정보 등 더 다양한 정보를 저장할 수 있다. 
Proton Pass를 분석할 때는 무료로 저장할 수 있는 정보들만 저장해서 분석할 것이다. 
샘플 데이터로는 로그인 정보, PIN, 메모, 신원 정보만을 저장했다.
![[Pasted image 20250724095718.png]]
위의 사진에서 보이듯이, 로그인 정보에서 비밀번호의 경우, 해당 비밀번호가 얼마나 강하고 약한지를 특정 기준에 따라 강함부터 취약함까지 분류하는 것을 확인할 수 있었다. 
### 아티팩트 분석
이제 Proton Pass의 아티팩트를 분석해 보자. 
먼저 `databases`폴더부터 분석해 보면, 다음과 같이 여러 파일들이 있는 것을 확인할 수 있다. 
![[Pasted image 20250724111107.png]]
여기서 주목할 것은 `com.google.android.datatransport.events` 파일과 `db-passkey` 파일이다. 이 둘을 먼저 Hex editor로 열어 보면 둘 다 `SQLite Format 3`라는 문자열로 시작하기 때문에 데이터베이스 파일과 관련된 파일이라는 것을 확인할 수 있다. 
먼저 `com.google.android.datatransport.events`파일을 SQLCipher로 열어 보면 `events_metadata` 테이블에 유의미한 정보가 저장되어 있는 것을 확인할 수 있었으며, 해당 테이블에 저장된 정보는 사용자의 국가 정보, 핸드폰의 모델명, SDK 버전 등 다양한 메타데이터가 저장되어 있다. 
![[Pasted image 20250724112152.png]]
그 다음 `db_passkey`파일을 열어 보면 다양한 테이블이 저장되어 있었는데, 
![[Pasted image 20250724120101.png]]
이 많은 테이블들 중 의미 있는 정보가 담겨져 있던 테이블은 총 7가지 테이블로 간결하게 요약할 수 있다.
1. AccountEntity: 사용자 계정(이메일 등)의 정보
2. AddressKeyEntity: 주소와 관련된 키 정보 (비밀키, 토큰, 서명 등)
3. ItemEntity: 사용자가 저장한 로그인 정보나 노트를 암호화해서 저장
4. KeySaltEntity: 키의 ID와 그에 대한 Salt값
5. ShareKeyEntity: 대칭 암호화에 사용되는 키를 BLOB 형태로 저장
6. UserEntity: 사용자에 대한 정보
7. UserKeyEntity: 사용자의 정보를 암호화하는 키에 대한 정보

그 다음, `no_backup`이라는 폴더를 분석해 보면 `androidx.work.workdb`라는 파일을 발견할 수 있는데, 파일 이름이 `db`로 끝나니 Hex editor에 넣어 보면, 다음과 같이 SQLCipher로 열 수 있다는 것을 확인할 수 있었다. 
![[Pasted image 20250724130921.png]]
![[Pasted image 20250724130924.png]]
`androidx.work.workdb`파일을 SQLCipher로 열어 보면 다양한 테이블을 발견할 수 있었는데, 우리는 이 중에서`WorkName`, `WorkSpec`, `WorkTag` 이 세 개만 분석해 보기로 하자. 
먼저, 공통적으로 Work라는 이름이 붙은 것으로 봐서, 아직 APK 파일을 뜯어서 분석 중이기는 하지만 애플리케이션 내부에서 이뤄지는 작업에 대한 정보가 들어있는 것으로 추측된다.
또한, 공통적으로 `work_spec_id` 열이 있는 것으로 봐서, 작업의 ID에 대한 정보도 같이 들어있는 것으로 추측된다. 

그 다음은 SharedPreferences를 볼 차례인데, 다음처럼 파일도 몇 개 없고, 열어봤자 Unix timestamp밖에 없어 SharedPreferences에서는 딱히 주목할 만한 자료가 없는 것으로 판단해서 넘어갔다. 
![[Pasted image 20250724131506.png]]

마지막으로 `pass.key`파일을 확인해 볼 텐데, 이 파일을 Hex editor로 열어 보면 다음과 같이 데이터 자체의 길이도 별로 길지 않고, SQLCipher로 열어 볼 수도 없어서 해당 파일은 암호화 알고리즘이나 복호화 알고리즘에 사용되는 키 그 자체인 것으로 추측하고, [[Proton Pass 동작 알고리즘 분석]]에서 [[Jadx|Jadx]]로 APK를 분석할 때 키워드로 사용할 것이다. 
![[Pasted image 20250724131815.png]]
