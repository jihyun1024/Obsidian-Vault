## 들어가며
---
### 들어가며
---
이번 강의에서는 [devtools-sources](https://dreamhack.io/wargame/challenges/267) 워게임을 풀어보면서 브라우저에서 제공하는 개발자 도구를 사용하는 실습을 진행한다. 

브라우저의 개발자 도구는 웹 개발과 관련한 다양하고 강력한 기능들을 제공한다. 본 문제의 풀이에서는 개발자 도구의 `Source` 탭을 이용하며, 소스 코드를 열람하고 검색해 본다. 

이번 강의의 풀이 과정은 기본적으로 Chrome 브라우저를 사용하며, Firefox 브라우저를 사용한 풀이 및 관련 설명은 부록 형식으로 추가되었다. 또한, [[Dreamhack 워게임 풀이 템플릿]]은 이번 문제 한정으로 사용하지 않는다. 


## 분석 및 풀이
---
### 분석
---
주어진 문제를 확인하고 간단하게 분석해 보자. 

devtools-source 문제의 `문제 파일 받기` 버튼을 눌러서 문제 파일을 다운로드 받고, 해당 파일의 압축을 해제하면, 지금까지 살펴봤던 HTML, CSS, JS 등 웹 페이지를 이루는 다양한 리소스들이 존재하며, 해당 웹 페이지를 열면 그 리소스들이 복합적으로 작용해 개발자가 원하는 페이지를 출력하게 된다. 

대부분의 웹 서비스에서 진입점 페이지에 해당하는 `index.html`을 브라우저를 사용해 열어보자. 

![[Pasted image 20251231153201.png]]

그 결과, 사용자가 상호작용할 수 있는 메뉴 등을 담고 있는 페이지를 열람할 수 있다. 해당 메뉴를 사용하거나, 파일에서 해당하는 HTML 파일을 직접 여는 것으로, 문제 내부에 있는 다양한 페이지에 접근할 수 있다. 


### 풀이
---
문제의 설명을 보면, 개발자 도구의 Source 탭 기능을 활용해서 플래그를 찾아보라는 언급이 있다. 또한 플래그 형식이 `DH{}`이므로, `DH` 문자열을 검색하는 것으로 문제에서 제공한 페이지 및 소스 내 어딘가에 존재하는 플래그를 찾을 수 있을 것이다. 

<u>웹 페이지가 열려 있는 상태에서,</u> F12를 눌러 개발자 도구를 연 뒤 Source 탭에 접근해 보자. 

![[Pasted image 20251231153600.png]]

그 결과, 위의 사진과 같이 웹 페이지를 구성하고 있는 요소를 확인할 수 있다. 이제 `DH` 문자열을 찾아야 하는데, 노가다로 하나씩 열어 보면서 찾을 수도 있지만, Windows/Linux는 Ctrl + Shift + F 단축키로, MacOS는 Cmd + Opt + F 단축키로 모든 파일에 대해 검색을 수행할 수 있다. 

해당 커맨드를 입력하면, 하단에 검색 패널이 등장한다. 해당 패널에 `DH` 문자열을 입력하면, `main.scss`에서 플래그를 확인할 수 있다. 

![[Pasted image 20251231153842.png]]


## 부록
---
### Firefox 환경에서의 문제 풀이
---
Firefox 브라우저의 경우, Chrome 브라우저와는 다르게 문제를 해결하는 방식에 차이가 있다. Firefox 개발자 도구의 최상단에는 Source 탭이 존재하지 않는다. 대신, Debugger 탭의 하위에 존재하는 Source 탭을 눌러 해당 메뉴에 접근할 수 있다. 

F12를 눌러 개발자 도구를 열고 Debugger 탭에 접근하여 Source 탭을 누르면 해당 페이지를 구성하는 요소들을 Chrome에서처럼 확인할 수 있다. 

![[Pasted image 20251231154127.png]]

여기서 Ctrl + Shift + F 단축키를 누르거나 Search 탭을 누르면, 전체 파일을 대상으로 문자열을 검색할 수 있다. 

문제는, 해당 패널에 `DH` 문자열을 검색할 경우 그 결과가 보이지 않는다는 점이다. 실제로 플래그가 존재했던 `webpack://styles/main.scss`에 해당하는 파일이 Firefox 브라우저에서는 없다. 

![[Pasted image 20251231154334.png]]

이 이유를 알아보기 위해 webpack과 sourcemap의 개념을 간략하게 알아보자. 


### webpack과 sourcemap
---
#### webpack
webpack은 웹에서 사용하는 에셋을 번들링해주는 모듈 번들러이다. 

웹을 개발하는 과정에서 개발자는 많은 수의 `js`, `css` 등등 다양한 에셋 파일을 작성하고 사용하게 된다. 웹 페이지를 로드하기 위해서는 해당 파일을 전부 로드할 필요가 있는데, 이는 오랜 시간이 걸리는 작업이다. 

따라서 이 문제를 해결하고자 등장한 기술이 **번들러**로, webpack과 같은 번들러는 개발자가 사용하고 있는 에셋을 하나의 파일로 처리&병합한 뒤 압축해서 페이지 로드에 필요한 에셋들을 더 신속하게 처리할 수 있도록 한다. 

실제로 내부에 존재하는 `.map` 파일, Chrome 브라우저에서 봤던 `webpack://` 등을 통해 webpack 번들러가 사용된 흔적을 확인할 수 있다. 

#### sourcemap
webpack을 사용하면, 파일들을 하나의 파일로 변환하고 압축하는 과정에서 함수 이름, 변수명, 라인 정보 등의 정보가 소실된다. 이는 개발자가 페이지를 디버깅하고자 할 때 걸림돌이 될 수 있다. 

이 문제를 해결하기 위해 등장한 개념이 **sourcemap**으로, 원본 에셋 파일과 변환된 파일 사이의 매핑 정보를 담고 있는 파일이다. 브라우저는 해당 파일을 읽어, 변환된 파일의 각 부분에 대응하는 원본 파일을 찾을 수 있으며, 이 정보를 개발자에게 보여줘 디버깅을 편리하게 한다. 

내부에 존재하는 `.map` 파일이 sourcemap에 해당하며, Chrome 브라우저의 경우 해당 파일을 읽어들여 적절하게 파싱 작업을 거친 후 내부에 존재하는 파일을 `webpack://`의 하위 경로에 보여줬던 것이다. 

Firefox 브라우저도 동일한 작업을 수행하지만, 본 문제 파일에 대해서는 정상적으로 처리하지 못하는 문제가 존재한다. 이를 해결해 보자. 


### Firefox 환경에서의 문제 풀이 (revisited)
---
내부의 `main.4c6e144e.js` 를 확인하면, `No source map found`라는 문구를 확인할 수 있다.

이는 Firefox가 sourcemap 파일에 해당하는 `.map` 파일을 대응하는 `.js` 파일에서 찾지 못했기 때문으로, 이 문제를 해결하기 위해 `main.4c6e144e.js` 파일의 끝에 새로운 줄을 만들고, 다음과같은 내용을 추가한다. 

```
//# sourceMappingURL=main.4c6e144e.map
```

![[Pasted image 20251231165311.png]]

이 방식을 통해 임의로 sourcemap 파일의 경로를 지정할 수 있다. 이후 Firefox의 페이지를 새로고침하면, 다음과 같이 `main.scss` 파일을 찾아왔음을 확인할 수 있다. 

![[Pasted image 20251231165408.png]]

또한 이 상태에서 `DH` 문자열을 검색하면 플래그를 획득할 수 있다.

![[Pasted image 20251231165438.png]]
