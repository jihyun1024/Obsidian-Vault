---
tags:
  - 수업_정리
  - 암호학
title:
---
## 학습 주제
1. NTT example
2. $NTT^{-1}$ (Kyber)
3. NTT 연산

---
## 연관 수업
[[양자보안_9주차_월요일]]
[[양자보안_9주차_수요일]]
[[양자보안_10주차_월요일]]
[[양자보안_10주차_수요일]]
[[양자보안_11주차_월요일]]
[[양자보안_11주차_수요일]]

---
## 수업과 관련한 질문 3가지
1. Dilithium NTT의 경우, $Z_q$에 해당하는 원소의 형태인데, 이렇게 설정하는 이유
2. ML-KEM-768과 AES-256의 총 연산 시간은 어느 정도의 차이가 나는지
3. Lattice에서 각각의 벡터를 다항식으로 표현할 수 있을지

---
## 강의 요약
이번 강의에서도 저번 강의들에서 다룬 내용을 바탕으로 복습 위주로 공부한다. 
### NTT example
이전 강의의 가정을 참고해, 이 사진에 해당하는 NTT 변환에 대하여 정리해 보자.
![[Pasted image 20251118060856.png]]

$a(x)$는 7차 이하의 식이지만, 우리는 해당 식을 NTT 변환을 통해 7차식 한 개를 1차식 4개로 변환하려 한다. 이를 **NTT(Number Theoretic Transformation)** 이라 한다. 

이 때, $x^4$의 여부를 기준으로 각각 3차 이하의 다항식인 $a_L(x)$와 $a_R(x)$로 나눌 수 있으며, $\zeta=10$이며 order는 8, 즉 $\zeta^8 = 1, \zeta^4 = -1$이고, $R_q$에서는 $x^8 + 1$이 전체를 통제한다. 

이는 $x^8 + 1$ 다항식을 $x^8 - \zeta^4$으로 표시할 수 있으며, 이를 **인수분해**하면 $x^8 - \zeta^4 = (x^4 - \zeta^2)(x^4 + \zeta^2)$으로 나타난다. 따라서, $a_0(x) = a(x)\ mod\ (x^4 - \zeta^2)$은 $x^4 = \zeta^2$이라는 사실과 $x^4$ 기준으로 $a(x)$를 나눈 3차 이하 다항식 2개를 사용해 $a_L(x)+\zeta^2a_R(x)$로 나타낸다. 
이는 $a_1(x) = a(x)\ mod\ (x^4 + \zeta^2)$도 마찬가지 방법으로 나타낼 수 있다. 

하지만, 우리는 거기서 그치지 않고, 더 이상 $mod$에 해당하는 다항식이 인수분해 되지 않을 때까지 인수분해 하고 싶은 것이기 때문에, $\zeta$의 거듭제곱 앞의 부호가 $-$이면 0을, $+$이면 1을 사용해 $a(x)$를 여러 덩어리로 나눈다. 

해당 과정들은 3번째 문단에서 서술한 것과 동일하게 진행되며, 만약 부호가 $+$인 경우에는 $\zeta^4 = -1$임을 사용해 $\zeta$의 거듭제곱 앞의 부호가 $-$가 되게 만들어 진행한다. 
해당 과정들을 정리한 노트를 보자. 
![[Pasted image 20251118062620.png]]

해당 예시에서는 8개의 칸을 2칸씩 4개의 덩어리로 나눴는데, 이를 어떻게 역변환 할 수 있을까?

### $NTT^{-1}$ (Kyber)
리버스 엔지니어링을 잘 하기 위해서 먼저 해당 프로그래밍에 대해 잘 알고 있어야 하는 것처럼, **NTT의 역변환**을 연산하기 위해서는 어떻게 NTT를 계산했는지 자세하게 알고 있어야 한다. 

우리는 NTT 변환 예제에서 $a_L(x)$와 $a_R(x)$를 먼저 분리하고 나서 $a_0(x), a_1(x)$를 계산했으며, 식은 다음과 같다. 

- $a_0(x) = a_L(x) + \zeta^4a_R(x)$
- $a_1(x) = a_L(x) - \zeta^4a_R(x)$

이 두 식에서 $\zeta^4a_R(x)$에 대해 식을 정리함으로써 $a_L(x)$와 $a_R(x)$를 역산해 낼 수 있다.
따라서, $a_L(x) = (a_0(x) + a_1(x)) / 2$이며, $a_R(x) = (a_0(x) - a_1(x))/(2\zeta^4)$이다. 

이 때, 표현의 간단함을 위해서 분수 표현을 사용했지만, 컴퓨터는 분수 표현을 이해하지 못하기 때문에 분수 표현은 실제로는 역원 연산으로 계산된다. 

2에 대한 곱셈 역원은 찾기 쉬우며, **$\zeta$에 대한 곱셈 역원**이 문제인데, 이는 $\zeta^8 = 1$을 사용해 해결할 수 있다. $\zeta^8 = 1$이라면 $\zeta^7 \times \zeta = 1$이고, 이는 곧 $\zeta^7$이 $\zeta$에 대한 역원임을 알 수 있다. 

따라서, $a_L(x)$와 $a_R(x)$를 찾았다면, 7차식 $a(x)$는 $a_L(x) + x^4a_R(x)$를 계산해 찾을 수 있다. 이 과정들은 $a_{00}(x)$와 $a_{01}(x)$에서 $a_0(x)$를 찾아내는 과정에서도 써먹을 수 있다. 

### NTT 연산
위에서 배운 내용들을 바탕으로, $NTT(a) \times NTT(b) = NTT(c)$를 계산해 보자. 해당 문제는 시험공부를 할 때 전 과정을 직접 손으로 계산해 보면 도움이 많이 될 것이다. 
![[Pasted image 20251118064137.png]]

이 때, NTT에서는 각 1차식들이 component-wise하게 계산된다는 것을 잊지 말자. 

---
## 중요한 단어
1. NTT (Number Theoretic Transformation)
2. 차수를 통제하는 다항식의 인수분해
3. NTT의 역변환 (Kyber)
4. $\zeta$에 대한 곱셈 역원
